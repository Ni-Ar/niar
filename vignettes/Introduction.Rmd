---
title: "Introduction"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 7, fig.height = 4
)
```

```{r setup}
library(niar)
```

Generate fake gene names
```{r}
set.seed(16)
n = 15000
sapply(1:n, function(x) {
  x <- paste0(c(sample(LETTERS, 1, replace = TRUE),
      tolower(sample(LETTERS, 4, replace = TRUE)),
      sample(1:9, 1, replace = TRUE)), collapse = "") } 
  ) -> rows_IDs

j <- length(unique(rows_IDs))
```

Show negative binomial distribution of simulated RNA-seq
```{r}
hist(rnbinom(n = j, mu = 400, size = 4), breaks = 40 )
```

Generate a count matrix with 10 RNA-seq samples.
```{r}
data.frame(Sample1 = rnbinom(n = j, mu = 400, size = 4)*rnorm(n = 1, mean = 2, sd = 0.5),
           Sample2 = rnbinom(n = j, mu = 395, size = 4)*rnorm(n = 1, mean = 2, sd = 0.5),
           Sample3 = rnbinom(n = j, mu = 396, size = 4)*rnorm(n = 1, mean = 2, sd = 0.5),
           Sample4 = rnbinom(n = j, mu = 397, size = 4)*rnorm(n = 1, mean = 2, sd = 0.5),
           Sample5 = rnbinom(n = j, mu = 430, size = 5)*rnorm(n = 1, mean = 2, sd = 0.5), 
           Sample6 = rnbinom(n = j, mu = 450, size = 5)*rnorm(n = 1, mean = 2, sd = 0.5), 
           Sample7 = rnbinom(n = j, mu = 420, size = 5)*rnorm(n = 1, mean = 2, sd = 0.5), 
           Sample8 = rnbinom(n = j, mu = 410, size = 6)*rnorm(n = 1, mean = 2, sd = 0.5), 
           Sample9 = rnbinom(n = j, mu = 400, size = 6)*rnorm(n = 1, mean = 2, sd = 0.5), 
           Sample0 = rnbinom(n = j, mu = 390, size = 6)*rnorm(n = 1, mean = 2, sd = 0.5), 
           stringsAsFactors = FALSE, 
           row.names = unique(rows_IDs) ) -> df
mat <- as.matrix(df)
```

Scale the matrix
```{r}
mat <- log2(mat)
```

Super easy to use!
```{r}
showme_PCA2D(mat)
```

Show extra plots, also easy!
```{r}
showme_PCA2D(mat = mat, show_variance = T, show_stats = T)
```

Checking loadings real quick? Very easy!
```{r}
showme_PCA2D(mat = mat, n_loadings = 12)
```

What to show extra info on the plot? Make a metadata dataframe.
```{r}
data.frame(sample_name = paste0("Sample", 0:9),
           replicate = c(rep(c(1:3), 3), 1), 
           condition = c(rep("A", 5), rep("Z", 5)),
           stringsAsFactors = FALSE) -> mt
```

Now specify the metadata with `mt` and the dataframe colum with the `mat` column names with `mcol` and now the extra info can be used to colour and label the points.
```{r}
showme_PCA2D(mat = mat, mt = mt, mcol = "sample_name", x = 1, y = 3,
             m_label = "replicate", m_fill = "condition")
```

Select top rows to use for PCA.
```{r}
showme_PCA2D(mat = mat, mt = mt, mcol = "sample_name", x = 1, y = 3,
             n_top_var = 40, m_fill = "replicate", m_label = F)
```

Do not use realistic aspect ratio.
```{r}
showme_PCA2D(mat = mat,  mt = mt, mcol = "sample_name", 
             m_fill = "replicate", x = 1, y = 3,
             show_stats = F, m_label = F, 
             real_aspect_ratio = F)
```